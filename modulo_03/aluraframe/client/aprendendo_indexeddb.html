<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Aprendendo IndexedDB</title>
</head>

<body>
    <script>
        // retorna uma instancia de IDBOpenDBRequest
        // pode abrir ou nao a conexao
        // eventos
        // openRequest.onupgradeneeded;
        // openRequest.onsucess;
        // openRequest.onerror;

        // IDBDatabase
        var connection;
        // precisa incrementar a versao caso seja necessario criar object stores depois de criado o banco
        var openRequest = window.indexedDB.open("aluraframe", 2);
        openRequest.onupgradeneeded = function (e) {
            console.log('Cria ou altera um banco já existente');

            var minhaConnection = e.target.result;
            // Object Store é semelhante a tabelas (não tem esquema)
            minhaConnection.createObjectStore('negociacoes');
        };

        //openRequest.onsuccess = function (e) {
        openRequest.onsuccess = e => {
            console.log('Conexão obtida com sucesso');
            // e.target.result
            connection = e.target.result;
        };

        openRequest.onerror = function (e) {
            console.log(e.target.error);
        };
    </script>
</body>

</html>